{% extends 'base.html' %}
{% block content %}

<div class="d-flex justify-content-between mb-3">
  <h3>Scan Tasks</h3>
  <a class="btn btn-success" href="{% url 'scans:add' %}">New Scan</a>
</div>

<table class="table table-striped">
  <thead>
    <tr>
      <th>Tool</th>
      <th>Target</th>
      <th>Status</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for s in scans %}
    <tr>
      <td>{{ s.tool.name }}</td>
      <td>{{ s.target.name }}</td>
      <td>
        <span class="badge bg-success">{{ s.status }}</span>
      </td>
      <td>
        {% if s.result %}
          <a class="btn btn-sm btn-info" href="{% url 'scans:export' s.id %}">Export</a>
        {% endif %}
        <a class="btn btn-sm btn-danger" href="{% url 'scans:delete' s.id %}">Delete</a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

{% for s in scans %}
  {% if s.result %}
    <div class="card mb-3">
      <div class="card-header">
        Result: {{ s.tool.name }} â†’ {{ s.target.name }}
      </div>
      <div class="card-body">
        <pre class="small">{{ s.result.output }}</pre>
      </div>
    </div>
  {% endif %}
{% endfor %}

{% endblock %}
